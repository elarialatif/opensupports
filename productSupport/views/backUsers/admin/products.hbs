<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<div class="main-layout-header">
    <div class="main-layout-header__login-links">

        <button class="button button_clean button_large" onclick="location.href='/admin/allUsers'">
            users
        </button>
        <button class="button button_clean button_large" onclick="location.href='/admin/products'">
            products
        </button>
        <button class="button button_clean button_large" onclick="location.href='/admin/tickets/all'">
            tickets
        </button>
    </div>
    <div class="drop-down drop-down_closed language-selector main-layout-header__languages">
        <div aria-expanded="false" aria-autocomplete="list" aria-owns="drop-down-menu_1"
             aria-activedescendant="drop-down-menu_1__0" class="drop-down__current-item"
             role="combobox" tabindex="0">
            <div><img class="drop-down__current-item-icon"
                      src="https://www.opensupports.com/demos/demo1/images/icons/us.png"
                      aria-hidden="true"><!-- react-text: 12 -->English
                <!-- /react-text -->
            </div>
        </div>
    </div>
</div>

<div class="container">

    <button type="button" class="btn btn-success " data-toggle="modal" data-target="#addModal">add Product</button>


    <!-- Modal -->
    <div id="addModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Modal Header</h4>
                </div>
                <div class="modal-body">
                    <label for="productName"> Name </label>
                    <input id="productName" name="name" class="form-control">
                </div>
                <div class="modal-footer">
                    <button type="submit" id="addProduct" class="btn btn-success">Save</button>
                </div>
            </div>

        </div>
    </div>
    <br>
    <br>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Code</th>
            <th>Name</th>
            <th>CreatedBY</th>
            <th>Date</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody id="productTableBody">
        {{#each products}}
            <tr>
                <td>{{id}}</td>
                <td>{{name}}</td>
                <td>admin</td>
                <td>{{time date 'D MMMM  YYYY'}}</td>
                <td><a href="/admin/products/delete/{{id}}" class="btn btn-danger">مسح</a>
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#editModal{{id}}">تعديل
                    </button>
                    <div id="editModal{{id}}" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                            <form method="post" action="/admin/products/update/{{id}}">
                            <!-- Modal content-->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title">add Product</h4>
                                </div>
                                <div class="modal-body">
                                    <label for="name"> Name </label>
                                    <input id="name" name="name" class="form-control" value="{{name}}">
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-success">Save</button>
                                </div>
                            </div>
                            </form>
                        </div>
                    </div>

                </td>
            </tr>
        {{/each}}
        </tbody>

    </table>
    <script>
        $("#addProduct").click(function () {
            var name = $('#productName').val();
            $.ajax({
                type: 'post',
                url: "/admin/products/create",
                data: {
                    name: name,
                },
                success: function (data) {
                    $('#productTableBody').append('<tr style="background-color:#09090926">' +
                            '<td>' + data._id + '</td>' +
                            '<td>' + data.name + '</td>' +
                            '<td>' + 'admin' + '</td>' +
                            '<td>' + '{{time data.date  'D MMMM  YYYY'}}' + '</td>' +
                            '<td>' + '<a href="products/delete/' + data._id + '" class="btn btn-danger">مسح</a>' + '</td>' +
                            '</tr>');
                    $('#addModal').modal('toggle');
                }
            });
        });

    </script>
</div>